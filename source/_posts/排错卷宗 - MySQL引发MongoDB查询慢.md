---
title: 排错卷宗 - MySQL引发MongoDB查询慢
categories:
- 排错卷宗
date: 2018-08-08  
tags:
- MongoDB
---
#### 场景还原
>`小B`：小A，你X业务的查询还是很慢呀！
>`小A`：不可能呀，我昨天刚优化过速度，溜溜地！
>`小B`：不信你自己试一下就知道了。
>`小A`：我去。。。还真的可慢。
>`小A`：不对！优化过后的查询效率是没有问题的，肯定是发生了其他的事情。
>`小A`：其他基于MongoDB的业务查询也变慢了，难道是MongoDB出现了问题？
>`小A`：啃爹呀！系统资源快被MySQL吃完了，MongoDB能不慢？

#### 问题定位
`微服务资源隔离`
微服务之间应该是资源隔离的。每个微服务在不同系统进程，每个微服务应该有自己的数据库。

`SHOW PROCESSLIST`
显示哪些线程正在运行。

`max_connections`
当遇到MySQL的连接数不够用时，不可盲目扩大该配置。此举虽然可以暂时结局问题，但可能引起更大的问题，应该以优化减少连接入手。

`MySQL dbuser`
不同的连接者尽量使用不同的dbuser，方便SHOW PROCESSLIST时，区别连接端。